# General Access Control Design
Переконайтеся, що програма забезпечує виконання правил контролю доступу на рівні довіренного сервісу, особливо якщо контроль доступу на стороні клієнта присутній і його можна обійти [cwe 602]

Переконайтеся, що всі атрибути користувача та даних, а також інформація про політику, яка використовується засобами керування доступом, не можуть бути маніпульовані кінцевими користувачами без спеціального дозволу. [cwe 639]

Переконайтеся, що використан принцип найменших привілеїв – користувачі повинні мати доступ лише до функцій, файлів даних, URL-адрес, контролерів, служб та інших ресурсів, для яких вони мають певний дозвіл. Це передбачає захист від підробки та підвищення привілеїв (С7) [cwe 285]

Переконайтеся, що засоби керування доступом безпечно виходять з ладу, у тому числі в разі виникнення винятку (С10) [cwe 285]

# C7
C7 - Контроль доступу (або авторизація) — це процес надання або відхилення конкретних запитів від користувача, програми або процесу. Контроль доступу також включає дію надання та скасування цих привілеїв.

Слід зазначити, що авторизація (перевірка доступу до певних функцій або ресурсів) не є еквівалентом автентифікації (підтвердження особи).

Функціональність контролю доступу часто охоплює багато областей програмного забезпечення залежно від складності системи контролю доступу. Наприклад, керування метаданими контролю доступу або створення кешування для цілей масштабованості часто є додатковими компонентами в системі контролю доступу, якими потрібно будувати або керувати. Існує кілька різних типів проектування контролю доступу, які слід розглянути.
- Дискреційний контроль доступу (DAC) — це засіб обмеження доступу до об’єктів (наприклад, файлів, об’єктів даних) на основі ідентичності та необхідності знати суб’єктів (наприклад, користувачів, процесів) та/або груп, до яких належить об’єкт .
- Обов’язковий контроль доступу (MAC) — це засіб обмеження доступу до системних ресурсів на основі конфіденційності (як представлено міткою) інформації, що міститься в системному ресурсі, і формального авторизації (тобто дозволу) користувачів на доступ до інформації з такої чутливості.
- Управління доступом на основі ролей (RBAC) — це модель керування доступом до ресурсів, у якій дозволені дії над ресурсами визначаються ролями, а не індивідуальними ідентифікаторами суб’єктів.
- Керування доступом на основі атрибутів (ABAC) надаватиме або відхилятиме запити користувачів на основі довільних атрибутів користувача та довільних атрибутів об’єкта, а також умов середовища, які можуть бути загальновизнаними та більш відповідними відповідним політикам.

# C10
С10 - Обробка винятків — це концепція програмування, яка дозволяє програмі різними способами реагувати на різні стани помилок (наприклад, несправність мережі, збій підключення до бази даних тощо). Правильна обробка винятків і помилок має вирішальне значення для надійності та безпеки вашого коду.

Обробка помилок і винятків відбувається в усіх областях програми, включаючи критично важливу бізнес-логіку, а також функції безпеки та код інфраструктури.

Обробка помилок також важлива з точки зору виявлення вторгнень. Певні атаки на вашу програму можуть викликати помилки, які можуть допомогти виявити поточні атаки.

# CWE 602
Продукт складається з сервера, який покладається на клієнта для реалізації механізму, призначеного для захисту сервера
Коли сервер покладається на механізми захисту, розміщені на стороні клієнта, зловмисник може змінити поведінку на стороні клієнта, щоб обійти механізми захисту, що призводить до потенційно неочікуваної взаємодії між клієнтом і сервером. Наслідки будуть різними залежно від того, що механізми намагаються захистити
Платформи: не залежить від мови
Часті наслідки: перевірки на стороні клієнта можна легко обійти, дозволяючи неправильно сформованому або неочікуваному введенню перейти в програму, потенційно як надійні дані. Це може призвести до неочікуваних станів, поведінки та, можливо, до збою
Шанс експлоіту: середній

# CWE 639
Функція авторизації системи не перешкоджає одному користувачеві отримати доступ до даних або запису іншого користувача шляхом зміни значення ключа, що ідентифікує дані.
Отримання запису користувача відбувається в системі на основі деякого значення ключа, яке знаходиться під контролем користувача. Ключ зазвичай ідентифікує пов’язаний з користувачем запис, що зберігається в системі, і використовуватиметься для пошуку цього запису для представлення користувачеві. Цілком ймовірно, що зловмисник повинен бути автентифікованим користувачем у системі. Однак процес авторизації не буде належним чином перевіряти операцію доступу до даних, щоб переконатися, що автентифікований користувач, який виконує операцію, має достатні повноваження для виконання запитуваного доступу до даних, отже обходячи будь-які інші перевірки авторизації, присутні в системі.
Наприклад, зловмисники можуть переглядати місця, де витягуються дані користувача (наприклад, екрани пошуку), і визначати, чи ключ для шуканого елемента можна контролювати ззовні. Ключ може бути прихованим полем у полі форми HTML, може передаватися як параметр URL-адреси або як незашифрована змінна cookie, тоді в кожному з цих випадків можна буде змінити значення ключа.
Одним із проявів цієї слабкості є те, що система використовує послідовні або інакше легко вгадані ідентифікатори сеансу, які дозволяють одному користувачеві легко переключатися на сеанс іншого користувача та читати/змінювати їхні дані.
Платформи: не залежить від мови
Часті наслідки: Перевірки контролю доступу для певних даних або функцій користувача можна обійти
Шанс експлоіту: високий

# CWE 285
Продукт не виконує або неправильно виконує перевірку авторизації, коли актор намагається отримати доступ до ресурсу або виконати дію.
Припускаючи, що користувач має певну ідентифікаційну інформацію, авторизація – це процес визначення того, чи може цей користувач отримати доступ до даного ресурсу, на основі привілеїв користувача та будь-яких дозволів або інших специфікацій контролю доступу, які застосовуються до ресурсу.
Коли перевірки контролю доступу не застосовуються послідовно або взагалі не застосовуються, користувачі можуть отримувати доступ до даних або виконувати дії, які їм заборонено виконувати. Це може призвести до широкого спектру проблем, включаючи розкриття інформації, відмову в обслуговуванні та довільне виконання коду
Платформи: не залежить від мови. Веб-сервер, сервер бази даних
Часті наслідки:  Зловмисник може прочитати конфіденційні дані, прочитавши дані безпосередньо зі сховища даних, яке належним чином не обмежено, або отримавши доступ до недостатньо захищеної привілейованої функції для читання даних.
Шанс експлоіту: високий

